syntax = "proto3";
package channel;
option go_package = "github.com/kagari-org/cryonet/gen/channel";

// only needed by ws connections
message Init {
  string id = 1;
  string token = 2;
}

message Packet {
  oneof packet {
    Normal normal = 1;
    Direct direct = 2;
  }
}

message Normal {
  string from      = 2;
  string to        = 3;
  oneof  payload {
    Alive       alive       = 4;
    Offer       offer       = 5;
    Answer      answer      = 6;
    Candidate   candidate   = 7;
  }
}

message Direct {
  bytes data = 1;
}


// payloads for normal packets

message Alive {
  repeated string peers = 1;
}

message Offer {
  string conn_id = 1;
  bool   restart = 2;
  bytes  data    = 3;
}

message Answer {
  bool  success = 1;
  bytes data    = 2;
}

message Candidate {
  bytes data = 1;
}
